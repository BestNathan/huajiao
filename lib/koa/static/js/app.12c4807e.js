(function(t){function e(e){for(var o,i,r=e[0],c=e[1],l=e[2],u=0,f=[];u<r.length;u++)i=r[u],n[i]&&f.push(n[i][0]),n[i]=0;for(o in c)Object.prototype.hasOwnProperty.call(c,o)&&(t[o]=c[o]);d&&d(e);while(f.length)f.shift()();return a.push.apply(a,l||[]),s()}function s(){for(var t,e=0;e<a.length;e++){for(var s=a[e],o=!0,i=1;i<s.length;i++){var c=s[i];0!==n[c]&&(o=!1)}o&&(a.splice(e--,1),t=r(r.s=s[0]))}return t}var o={},n={2:0},a=[];function i(t){return r.p+"js/"+({0:"vendors~flv"}[t]||t)+"."+{0:"290f7ab0"}[t]+".js"}function r(e){if(o[e])return o[e].exports;var s=o[e]={i:e,l:!1,exports:{}};return t[e].call(s.exports,s,s.exports,r),s.l=!0,s.exports}r.e=function(t){var e=[],s=n[t];if(0!==s)if(s)e.push(s[2]);else{var o=new Promise(function(e,o){s=n[t]=[e,o]});e.push(s[2]=o);var a=document.getElementsByTagName("head")[0],c=document.createElement("script");c.charset="utf-8",c.timeout=120,r.nc&&c.setAttribute("nonce",r.nc),c.src=i(t);var l=setTimeout(function(){u({type:"timeout",target:c})},12e4);function u(e){c.onerror=c.onload=null,clearTimeout(l);var s=n[t];if(0!==s){if(s){var o=e&&("load"===e.type?"missing":e.type),a=e&&e.target&&e.target.src,i=new Error("Loading chunk "+t+" failed.\n("+o+": "+a+")");i.type=o,i.request=a,s[1](i)}n[t]=void 0}}c.onerror=c.onload=u,a.appendChild(c)}return Promise.all(e)},r.m=t,r.c=o,r.d=function(t,e,s){r.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:s})},r.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/",r.oe=function(t){throw console.error(t),t};var c=window["webpackJsonp"]=window["webpackJsonp"]||[],l=c.push.bind(c);c.push=e,c=c.slice();for(var u=0;u<c.length;u++)e(c[u]);var d=l;a.push([81,1]),s()})({0:function(t,e){},81:function(t,e,s){t.exports=s("Vtdi")},Vtdi:function(t,e,s){"use strict";s.r(e);s("VRzm");var o=s("Kw5r"),n=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("q-layout",{attrs:{id:"q-app",view:"lHh Lpr lFf"}},[s("q-layout-header",[s("q-toolbar",{attrs:{color:"primary",inverted:"ios"===t.$q.theme}},[s("q-btn",{attrs:{flat:"",dense:"",round:"","aria-label":"Menu",icon:"live_tv"}}),s("q-toolbar-title",[t._v("\n        花椒弹幕广告机\n        "),s("div",{attrs:{slot:"subtitle"},slot:"subtitle"},[t._v("该项目仅供学习使用，任何其他使用与作者无关")])])],1)],1),s("q-page-container",[s("Content")],1),s("q-page-sticky",{directives:[{name:"show",rawName:"v-show",value:t.$store.state.curTabisLog,expression:"$store.state.curTabisLog"}],attrs:{position:"bottom-right",offset:[18,18]}},[s("q-btn",{attrs:{round:"",dense:"",color:"primary",icon:"clear"},on:{click:t.clearMessages}})],1),s("q-page-sticky",{attrs:{position:"bottom-right",offset:[18,58]}},[s("q-btn",{directives:[{name:"back-to-top",rawName:"v-back-to-top"}],attrs:{round:"",dense:"",color:"primary",icon:"keyboard_arrow_up"}})],1)],1)},a=[],i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("q-page",[s("q-tabs",{attrs:{"two-lines":"",align:"center"}},[s("q-tab",{attrs:{slot:"title",label:"操作设置",name:"tab-1",icon:"settings",default:""},on:{select:function(e){t.onSelected("setting")}},slot:"title"}),s("q-tab",{attrs:{slot:"title",label:"日志记录",name:"tab-2",icon:"message",count:t.count},on:{select:function(e){t.onSelected("log")}},slot:"title"}),s("q-tab",{attrs:{slot:"title",label:"观看直播",name:"tab-3",icon:"movie"},on:{select:function(e){t.onSelected("video")}},slot:"title"}),s("q-tab-pane",{attrs:{id:"settings",name:"tab-1","keep-alive":""}},[s("Settings")],1),s("q-tab-pane",{attrs:{id:"messages",name:"tab-2","keep-alive":""}},[s("Messages")],1),s("q-tab-pane",{attrs:{id:"huajiaoVideo",name:"tab-3","keep-alive":""}},[s("VideoHuajiao",{ref:"VideoHuajiao"})],1)],1)],1)},r=[],c=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("q-field",{attrs:{"icon-color":"primary",icon:"home",helper:"请输入房间号，留空为随机"}},[s("q-input",{attrs:{"float-label":"房间号",clearable:"",inverted:"",after:[{icon:"arrow_forward",content:!0,handler:function(){t.openURL(t.roomLink)}},{icon:"replay",content:!0,handler:function(){t.roomId=t.lastRoomId}}]},model:{value:t.roomId,callback:function(e){t.roomId=e},expression:"roomId"}})],1),s("q-field",{attrs:{"icon-color":"primary",icon:"timer",helper:"请输入时间间隔，最低10S"}},[s("q-input",{attrs:{"float-label":"时间间隔",type:"number",inverted:"",suffix:"秒"},on:{blur:t.onTimerBlur},model:{value:t.interval,callback:function(e){t.interval=e},expression:"interval"}})],1),s("q-field",{attrs:{"icon-color":"primary",icon:"send",helper:"请输入发送次数，最低10次"}},[s("q-input",{attrs:{"float-label":"发送次数",type:"number",inverted:"",suffix:"次"},on:{blur:t.onTimesBlur},model:{value:t.times,callback:function(e){t.times=e},expression:"times"}})],1),s("p"),s("q-field",{attrs:{"icon-color":"primary",icon:"message",helper:"弹幕消息，换行符分割，一行一句"}},[s("q-input",{attrs:{type:"textarea",clearable:"",inverted:"","max-height":t.textareaHeight},model:{value:t.content,callback:function(e){t.content=e},expression:"content"}})],1),s("p"),s("q-field",{attrs:{"icon-color":"primary",icon:"settings",helper:"弹幕模式，轰炸机模式仅限至尊特权会员"}},[s("q-radio",{attrs:{val:"normal",label:"普通模式&nbsp;"},model:{value:t.mode,callback:function(e){t.mode=e},expression:"mode"}}),s("q-radio",{attrs:{val:"fakechat",label:"假聊模式&nbsp;"},model:{value:t.mode,callback:function(e){t.mode=e},expression:"mode"}}),s("q-radio",{attrs:{val:"bomb",label:"轰炸机模式&nbsp;",disable:""},model:{value:t.mode,callback:function(e){t.mode=e},expression:"mode"}})],1),s("p"),s("q-field",{attrs:{"icon-color":"primary",icon:"play_arrow",helper:"弹幕机操作"}},[s("q-btn-group",{staticClass:"full-width"},[s("q-btn",{staticClass:"full-width",attrs:{color:"primary",label:"创建",icon:"create",disabled:!t.canCreate},on:{click:t.onCreateClick}}),s("q-btn",{staticClass:"full-width",attrs:{color:"primary",label:"暂停",icon:"pause"},on:{click:t.onPauseClick}}),s("q-btn",{staticClass:"full-width",attrs:{color:"primary",label:"继续",icon:"replay"},on:{click:t.onResumeClick}}),s("q-btn",{staticClass:"full-width",attrs:{color:"primary",label:"停止",icon:"stop"},on:{click:t.onStopClick}})],1)],1)],1)},l=[],u=(s("KKXr"),s("4IOb")),d=function(t){return u["b"].create({title:"提示",message:t,color:"primary",ok:!0})},f={name:"Settings",data:function(){return{textareaHeight:100,canCreate:!0,roomId:"",interval:void 0,times:void 0,mode:"normal",contents:[],content:"",lastRoomId:""}},computed:{disabled:function(){return!this.$store.state.connected},roomLink:function(){return"http://www.huajiao.com/l/"+this.roomId}},watch:{content:function(t){var e=t.split("\n").filter(function(t){return t});this.contents=e},roomId:function(t,e){e&&(this.lastRoomId=e)}},methods:{openURL:u["B"],onTimerBlur:function(){this.interval&&(this.interval=this.interval<10?10:this.interval)},onTimesBlur:function(){this.times&&(this.times=this.times<10?10:this.times)},onCreateClick:function(){this.createAd()},onPauseClick:function(){this.pauseAd()},onResumeClick:function(){this.resumeAd()},onStopClick:function(){this.stopAd()},createAd:function(){if(!this.$store.state.connected)return d("服务器未连接,请检查网络或等待连接...");var t=this.roomId,e=this.interval,s=this.times,o=this.mode,n=this.contents;if(e&&(e*=1e3),!n.length)return d("弹幕内容不能为空,请重新填写...");this.$store.state.socket.emit("create",{roomId:t,interval:e,times:s,mode:o,contents:n})},pauseAd:function(){this.$store.state.started&&this.$store.state.socket.emit("pause",this.roomId)},resumeAd:function(){this.$store.state.started||this.$store.state.socket.emit("resume",this.roomId)},stopAd:function(){this.$store.state.socket.emit("stopAd",this.roomId)}},mounted:function(){var t=this;this.content="主播真漂亮",this.$store.state.socket.on("onCreate",function(e){"success"==e.status&&(t.roomId=e.roomId,t.$store.state.flv="http://qh0-flv.live.huajiao.com/live_huajiao_v2/".concat(e.sn,".flv"),t.$store.state.hls="http://qh0-hls.live.huajiao.com/live_huajiao_v2/".concat(e.sn,"/index.m3u8"),t.canCreate=!1)}),this.$store.state.socket.on("onStop",function(e){e&&"stop"!==e||(t.canCreate=!0)})}},h=f,p=s("KHd+"),m=Object(p["a"])(h,c,l,!1,null,null,null),v=m.exports,b=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{directives:[{name:"show",rawName:"v-show",value:t.showList,expression:"showList"}]},[s("q-list",{attrs:{highlight:""}},t._l(t.items,function(e){return s("q-item",{key:e.$index},[s("q-item-side",[s("q-item-tile",{attrs:{icon:t.iconForStatus[e.status],color:t.colorForStatus[e.status]}})],1),s("q-item-main",{attrs:{label:e.message}})],1)}))],1),s("div",{directives:[{name:"show",rawName:"v-show",value:!t.showList,expression:"!showList"}]},[t._v("\n        没有日志记录\n    ")])])},g=[],w={success:"green",fail:"red",info:"yellow"},y={success:"check",fail:"close",info:"info"},I={name:"Messages",data:function(){return{colorForStatus:{},iconForStatus:{}}},computed:{items:function(){return this.$store.state.messages},showList:function(){return!!this.$store.state.messages.length}},mounted:function(){this.colorForStatus=w,this.iconForStatus=y}},k=I,q=Object(p["a"])(k,b,g,!1,null,null,null),C=q.exports,O=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("q-field",{directives:[{name:"show",rawName:"v-show",value:t.supported&&t.canPlay,expression:"supported && canPlay"}],staticClass:"row q-ma-sm"},[s("div",{staticClass:"videoContainer"},[s("video",{staticClass:"centeredVideo",attrs:{id:"huajiao",playsinline:"",controls:"",autoplay:""}},[t._v('"对不起该浏览器暂不支持最新的HTML5特性，请使用现代浏览器."')])]),s("q-btn-group",{staticClass:"full-width"},[s("q-btn",{staticClass:"full-width",attrs:{color:"primary",label:"重新加载",icon:"autorenew"},on:{click:t.load}}),s("q-btn",{staticClass:"full-width",attrs:{color:"primary",label:"开始播放",icon:"play_arrow"},on:{click:t.play}}),s("q-btn",{staticClass:"full-width",attrs:{color:"primary",label:"暂停播放",icon:"pause"},on:{click:t.pause}})],1)],1),s("q-field",{directives:[{name:"show",rawName:"v-show",value:!t.supported,expression:"!supported"}],attrs:{label:"该设备暂不支持，无法播放直播"}}),s("q-field",{directives:[{name:"show",rawName:"v-show",value:!t.canPlay,expression:"!canPlay"}],attrs:{label:"未获取到播放地址，请先创建弹幕机"}})],1)},H=[],L={name:"videoHuajiao",data:function(){return{ele:null,player:null,isHls:!1,isFlv:!1}},computed:{hasFlv:function(){return!!this.$store.state.flv},hasHls:function(){return!!this.$store.state.hls},supported:function(){return this.isHls||this.isFlv},canPlay:function(){return this.isHls&&this.hasHls||this.isFlv&&this.hasFlv}},methods:{load:function(){return this.isFlv?this.loadFlv():this.isHls?this.loadHls():void 0},play:function(){return this.isFlv?this.playFlv():this.isHls?this.playHls():void 0},pause:function(){return this.isFlv?this.pauseFlv():this.isHls?this.pauseHls():void 0},destroy:function(){return this.isFlv?this.destroyFlv():this.isHls?this.destroyHls():void 0},loadHls:function(){this.pauseHls(),this.ele.src="",this.isHls&&(this.ele.src=this.$store.state.hls,this.playHls())},playHls:function(){this.isHls&&this.ele.play()},pauseHls:function(){this.isHls&&this.ele.pause()},destroyHls:function(){this.isHls&&(this.ele.src="")},loadFlv:function(){this.isFlv&&this.hasFlv&&(this.destroyFlv(),this.player=this.$flv.createPlayer({type:"flv",url:this.$store.state.flv,hasAudio:!0,hasVideo:!0,isLive:!0},{enableWorker:!0,lazyLoadMaxDuration:180,seekType:"range"}),this.player.attachMediaElement(this.ele),this.player.load())},playFlv:function(){this.player.play()},pauseFlv:function(){this.player.pause()},destroyFlv:function(){this.player&&(this.player.unload(),this.player.detachMediaElement(),this.player.destroy(),this.player=null)}},mounted:function(){var t=this;this.ele=document.getElementById("huajiao"),this.ele.canPlayType("application/vnd.apple.mpegurl")?(this.isHls=!0,this.load()):s.e(0).then(s.bind(null,"GUcZ")).then(function(e){t.$flv=e.default,t.isFlv=t.$flv.isSupported(),t.load()})}},$=L,S=(s("ZSbf"),Object(p["a"])($,O,H,!1,null,"1e705510",null)),x=S.exports,j={name:"Content",components:{Settings:v,Messages:C,VideoHuajiao:x},computed:{count:function(){return this.$store.state.newCount}},methods:{onSelected:function(t){switch(t){case"setting":this.$store.state.curTabisLog=!1,this.$refs.VideoHuajiao&&this.$refs.VideoHuajiao.destroy();break;case"log":this.$store.state.curTabisLog=!0,this.$store.commit("clearNewCount"),this.$refs.VideoHuajiao&&this.$refs.VideoHuajiao.destroy();break;case"video":this.$store.state.curTabisLog=!1,this.$refs.VideoHuajiao&&this.$refs.VideoHuajiao.load()}}}},F=j,T=Object(p["a"])(F,i,r,!1,null,null,null),_=T.exports,U={name:"LayoutDefault",components:{Content:_},data:function(){return{leftDrawerOpen:this.$q.platform.is.desktop}},methods:{clearMessages:function(){this.$store.commit("clearMessages")},addMessage:function(){this.$store.state.messages.push({status:"info",message:"test"})},createAd:function(){this.$store.state.socket.emit("create",{contents:"主播真漂亮(来自从不说假话的机器人)"})}}},P=U,B=(s("ZL7j"),Object(p["a"])(P,n,a,!1,null,null,null)),R=B.exports,M=(s("pKwj"),s("0ed0")),Q=(s("KCao"),s("flf9"),s("rGqo"),s("gFX4")),D=s.n(Q),V=(s("yt8O"),s("T39b"),s("L2JU"));o["a"].use(V["a"]);var N=new V["a"].Store({state:{socket:null,messages:[],newCount:0,curTabisLog:!1,connected:!1,interval:void 0,times:void 0,roomId:"",mode:"normal",contents:[],contentInUse:new Set,started:!1,flv:"",hls:""},mutations:{clearMessages:function(t){t.messages=[],t.newCount=0},clearNewCount:function(t){t.newCount=0},incNewCount:function(t){!t.curTabisLog&&t.newCount++}}}),z=80,E="http://".concat(window.location.hostname,":").concat(z),A=D()(E);N.state.socket=A,A.on("connect_error",function(t){K({status:"fail",message:"服务器连接失败:"+t.message}),N.state.connected=!1}),A.on("reconnect",function(){K({status:"info",message:"服务器重连成功"})}),A.on("reconnecting",function(t){K({status:"info",message:"服务器正在重新连接...(".concat(t,")")})});var K=function(t){N.state.messages.push(t),N.commit("incNewCount"),N.state.curTabisLog||u["c"].create({message:t.message,timeout:1e3,icon:y[t.status],color:w[t.status],textColor:"black",position:"top-right"})};["onPause","onResume","onStopAd"].forEach(function(t){A.on(t,function(t){K(t)})}),A.on("connect",function(){N.state.connected=!0,K({status:"info",message:"服务器连接成功"})}),A.on("disconnect",function(){N.state.connected=!1,N.state.started=!1,K({status:"info",message:"服务器已断开"})}),A.on("onCreate",function(t){"success"==t.status?t.message="创建成功。房间号：".concat(t.roomId):t.message="创建失败。原因：".concat(t.message),K(t)}),A.on("onAddad",function(t){"success"==t.status?t.message="添加成功。当前数量："+t.count:t.message="添加失败。原因：".concat(t.message),K(t)}),A.on("onStart",function(t){N.state.started=!0,K({status:"info",message:"房间："+t+"，开始发送弹幕"})}),A.on("onStop",function(t){N.state.started=!1;var e=t?"停止发送。原因："+t:"弹幕发送完毕";K({status:"info",message:e})}),A.on("onSendsuccess",function(t){K({status:"success",message:"发送成功 | ".concat(t.content)})}),A.on("onSendfail",function(t){K({status:"fail",message:"发送失败 | ".concat(t.content)})}),o["a"].use(u["A"],{i18n:M["a"],components:{QBtn:u["d"],QBtnGroup:u["e"],QLayout:u["m"],QLayoutHeader:u["o"],QLayoutDrawer:u["n"],QPage:u["r"],QPageContainer:u["s"],QPageSticky:u["t"],QToolbar:u["y"],QToolbarTitle:u["z"],QList:u["p"],QListHeader:u["q"],QItemSeparator:u["j"],QItem:u["h"],QItemSide:u["k"],QItemMain:u["i"],QItemTile:u["l"],QTabs:u["x"],QTab:u["v"],QTabPane:u["w"],QField:u["f"],QInput:u["g"],QRadio:u["u"]},directives:{BackToTop:u["a"]},plugins:{Notify:u["c"],Dialog:u["b"]}}),o["a"].config.productionTip=!1,new o["a"]({render:function(t){return t(R)},store:N}).$mount("#app")},ZL7j:function(t,e,s){"use strict";var o=s("bP1M"),n=s.n(o);n.a},ZSbf:function(t,e,s){"use strict";var o=s("rBvK"),n=s.n(o);n.a},bP1M:function(t,e,s){},l8ur:function(t,e,s){var o={"./bounce.css":"PUmY","./bounceIn.css":"CliU","./bounceInDown.css":"pKm8","./bounceInLeft.css":"WWXe","./bounceInRight.css":"2oCq","./bounceInUp.css":"tg5a","./bounceOut.css":"853k","./bounceOutDown.css":"qbXy","./bounceOutLeft.css":"Bt10","./bounceOutRight.css":"Zrw1","./bounceOutUp.css":"kI+G","./fadeIn.css":"EHBt","./fadeInDown.css":"FiUO","./fadeInDownBig.css":"kzg4","./fadeInLeft.css":"DC5c","./fadeInLeftBig.css":"81dB","./fadeInRight.css":"74+S","./fadeInRightBig.css":"dHoL","./fadeInUp.css":"5/vb","./fadeInUpBig.css":"uK9C","./fadeOut.css":"Jc2o","./fadeOutDown.css":"k+pq","./fadeOutDownBig.css":"yIhU","./fadeOutLeft.css":"Xx1C","./fadeOutLeftBig.css":"pVV8","./fadeOutRight.css":"iTTW","./fadeOutRightBig.css":"lDgw","./fadeOutUp.css":"NRvT","./fadeOutUpBig.css":"I6Vv","./flash.css":"WKVH","./flip.css":"vaAy","./flipInX.css":"WLhn","./flipInY.css":"WQIU","./flipOutX.css":"csU/","./flipOutY.css":"uK2o","./headShake.css":"Iomn","./hinge.css":"CF6H","./jello.css":"gBTy","./lightSpeedIn.css":"632X","./lightSpeedOut.css":"0EOz","./pulse.css":"q5hK","./rollIn.css":"3HPs","./rollOut.css":"WSzb","./rotateIn.css":"SH0w","./rotateInDownLeft.css":"v2tj","./rotateInDownRight.css":"e5Zg","./rotateInUpLeft.css":"ifhg","./rotateInUpRight.css":"y4yY","./rotateOut.css":"3mUJ","./rotateOutDownLeft.css":"gTSn","./rotateOutDownRight.css":"Hqc8","./rotateOutUpLeft.css":"Y9Ea","./rotateOutUpRight.css":"/MMa","./rubberBand.css":"qrIa","./shake.css":"FfHN","./slideInDown.css":"eeoa","./slideInLeft.css":"qWPx","./slideInRight.css":"O3aI","./slideInUp.css":"IeMT","./slideOutDown.css":"q+3l","./slideOutLeft.css":"+FdI","./slideOutRight.css":"CkM9","./slideOutUp.css":"VwYb","./swing.css":"uWio","./tada.css":"M5GN","./wobble.css":"7VtN","./zoomIn.css":"OPPa","./zoomInDown.css":"JXdd","./zoomInLeft.css":"GZIC","./zoomInRight.css":"72gz","./zoomInUp.css":"l6Fa","./zoomOut.css":"zBUS","./zoomOutDown.css":"KsZc","./zoomOutLeft.css":"H9SI","./zoomOutRight.css":"+i/6","./zoomOutUp.css":"keWq"};function n(t){var e=a(t),o=s(e);return o}function a(t){var e=o[t];if(!(e+1)){var s=new Error("Cannot find module '"+t+"'");throw s.code="MODULE_NOT_FOUND",s}return e}n.keys=function(){return Object.keys(o)},n.resolve=a,t.exports=n,n.id="l8ur"},pKwj:function(t,e,s){},rBvK:function(t,e,s){}});
//# sourceMappingURL=app.12c4807e.js.map